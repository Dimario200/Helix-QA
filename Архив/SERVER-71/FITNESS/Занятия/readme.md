# Проверка и создание документа занятия

Для автотестирования созданы следующие сценарии:

- **`ExportZanyatiya`**
- **`arendaZalaZanyatiya`**
- **`grupovieZanyatiya`**
- **`PersonalnieZanyatiya`**
- **`VizitVSKZanyatiya`**
- **`VvodniiPaketUslug`**
- **`VvodnoeChlenstvo`**

## Описание автотеста проверки занятий - Аренда зала

1. **Сценарий: 01.** Я создаю данные для проверки занятий.
Удаляются все переменные, создаются данные для тестирования данной фичи: Помещение, Услуга с типом Аренда зала, Тренер, Клиент.

2. **Сценарий: 02.** Проверка созданных данных.
Проверка прошлого сценария на ошибки, если они есть, останавливает фичу.

3. **Сценарий: 03.** Проверка настройки аренды зала "Считать оказанной "В продаже/В занятие"".
Заходит по сохраненной навигационной ссылке в созданную услуг с типом "Аренда зала" и в ней устанавливается настройка оказывать услугу "В продаже".
Создаю продажу услуги. Потом через регистр Оказание услуг проверяю списалось ли она после продажи.
Потом возвращаюсь в настройки услуги с типом "Аренда зала" и выставляю условие что она оказывается "В занятие".
После изменения настройки создается запись на занятие с типом "Аренда зала". Затем идет также проверка через регистр Оказание услуг списалась ли услуга.

4. **Сценарий: 04.** Проверка настройки аренды зала "Требуется основание для записи".
По навигационной ссылке заходится в услугу Аренды зала и включается настройка "Требуется основание для записи".
И через экспортный сценарий который использователя для создания занятие в сценарии выше(пункт 3.) создается занятие и для этого сценария.

5. **Сценарий: 05.** Проверка настройки аренды зала "Использовать ассистента".
В услугу Аренда зала добавляется настройка Использовать ассистента и отключается Требуется основание.
Создается экспортом второй тренер, который будет в занятии использовать как ассистент.
И создается таким же экспортом как и выше занятие с условием , что, если поле Ассистент присутствует на форме и его видно, то оно будет заполненно.
Потом идет проверка списания услуги с проверкой подставился ли ассистент.

6. **Сценарий: 06.** Проверка настройки услуги аренды зала "Отметка прибытия авто/ручная".
В услуге отключается настройка использования ассистента. Создается занятие аренда зала, потом производится вход клиента через рецепцию. Затем через документ ЗаписьНаЗанятие проверяется добавилась ли отметка прибытия на занятие.

7. **Сценарий: 07.** Проверка смены в аренде зала услуги, помещения, переноса по времени.
Создается второе помещение, вторая услуга аренды зала. И создается эскпортом занятие аренды зала, сохраняется, а потом в созданном занятие заменяются: Помещение, Услуга и проверяется после сохранения как выйдет информация о смене данных в занятие.(В случае аренды зала на ее форме смена данных не видна).
Идет потом проверка через оказание услуг на новые данные в занятии.

8. **Сценарий: 08.** Проверка списания услуги аренды зала с настройками Если клиент:"Записан и не отменил" и "Записан, прибыл и подтвердил".
Сначала устанавливается настройка "Записан и не отменил", затем создается Аренда зала и сохраняется и проверяется появилось ли списание и разрешено ли оно.
Записан, прибыл и подтвердли не проверить, т.к кнопки подтверждения нет на форме Аренды зала.

9. **Сценарий: 09.** Проверка отмены аренды зала.
Создаются отмены занятий со стороны Клуба, Клиента и Клиента с опозданием на час(не прибыл на занятие в течение часа, то списание услуги идет).
Сначала создается одно занятие с отменой со стороны клиента, потом через документ "Запись на занятие"(новый который) проверяется была ли отменена запись и прописалась ли в отказах правильная причина.
Аналогично с отказом от Клуба.

10. **Сценарий: 10.** Проверка списания услуги аренды зала с помощью отмены занятия со штрафом.
Создалась причина отмена которая за опоздание списывает услугу.
Создается занятие от текущего времени на час назад, и проставляется отмена занятия которая позволяет списать услугу.

## Описание автотеста проверки занятий - Групповые занятия

1. **Сценарий: 01.** Я создаю данные для проверки занятий.
Создаются: Групповая услуга, Помещение, Тренер, Клиент.

2. **Сценарий: 02.** Проверка созданных данных.
Проверка прошлого сценария на ошибки, если они есть, останавливает фичу.

3. **Сценарий: 03.** Проверка настройки групповой услуги "Считать оказанной "В продаже/В занятие"".
Устанавливается в услуге настройка которая оказывается услугу в продаже, создается продажа и проверяется спишется ли услуга после продажи(проверяется через регистр Оказания услуг).
Меняется настройка на оказание в занятии, создается занятие с установкой всем отметок прибытия, после сохраняем занятие и проверяем также через Оказание услуг списалась ли услуга.

4. **Сценарий: 04.** Проверка настройки групповой услуги "Не требуется привлечение тренера".
Включается в услуге настройка > Создание занятия без тренера > Проверка списания услуги и как записалось занятие(с тренером или без) в регистре или в записи на занятие(в зависимости где сценарий проверяет).

5. **Сценарий: 05.** Проверка настройки групповой услуги "Требуется основание для записи".
Включается в услуге настройка > Создание занятие с проверкой на требование основания

6. **Сценарий: 06.** Проверка настройки групповой услуги "Использовать ассистента".
Включается настройка > Создается второй тренер > Создается занятие, где в поле ассистента добавляется второй тренер > Проверяется списание через регистр Оказание услуг и записался ли туда Ассистент.

7. **Сценарий: 07.** Проверка настройки групповой услуги "Отметка прибытия авто/ручная".
Отключается настройка ассистента в услуге и включается автоматическая отметка прибытия > Создается занятие с продажей основания и занятие записывается в статусе Запланировано > Открывается рецепция и делается вход с нее для клиента > В документе Запись на занятие проверяется проставилась ли отметка Прибыл.
Включается вместо автоматической отметки прибытия ручная > Создается точно такое же занятие как сверху > Открывается рецепция, с нее делается выход(т.к клиент используется один и тот же), а затем снова вход > Потом также через документ Запись на занятие проверяется чтобы отметка прибытия не проставилась.

8. **Сценарий: 08.** Проверка смены в групповом занятие тренера, услуги, переноса по времени.
Создаю помещение2, групповую услугу2 > Создаю занятие в статусе Запланировано и сохраняю > Открывается занятие по навигационной ссылке > Делается смена данных Помещения, Тренера, Услуги и покупка нового основания и выставляется статус Выполнено и отметка прибытия, и сохраняется занятие > Открывается опять навигационная ссылка этого занятия и уже проверяется как на форме занятия отображается смена данных(красные плашки с чего на что поменялось).

9. **Сценарий: 09.** Проверка списания групповой услуги с настройками Если клиент:"Записан и не отменил" и "Записан, прибыл и подтвердил".
Устанавливается в услуге настройка "Записан и не отменил" > Создается экспортом занятие > Проверяется через документ Запись на занятие разрешено ли списание услуги после выполнения занятия.
Устанавливается в услуге настройка "Записан, прибыл и подтвердил" > Создание эскпортом занятие, где есть проверка на кнопки подтверждения, если она есть, то ее нажимаем и ставится отметка прибытия > Проверяем в документе Запись на занятие разрешено ли списание и подтверждено ли оно.

10. **Сценарий: 10.** Проверка отмены группового занятия.
Создаются две причины отказа от Клиента и от Клуба > Создаются два занятия одно отменено по инициативе Клиента, второе по инициативе Клуба > Проверяется через документ Запись на занятие проставились корректные причины отказа и какой статус прибытия.

11. **Сценарий: 11.** Проверка списания групповой услуги с помощью отмены занятия со штрафом.
Создается причина отказа от Клиента со штрафом если клиент не пришел в течение часа > Создается занятие со временем начала на час назад от текущего времени и выставляется проводится > Проверяется через регистр Оказания услуг списалась ли услуга.

## Описание автотеста проверки занятий - Персональные занятия

1. **Сценарий: 01.** Я создаю данные для проверки занятий.
Создаются: Персональная услуга, Помещение, Тренер, Клиента.

2. **Сценарий: 02.** Проверка созданных данных.
Проверка прошлого сценария на ошибки, если они есть, останавливает фичу.

3. **Сценарий: 03.** Проверка настройки персональной услуги "Считать оказанной "В продаже/В занятие"".
Устанавливается настройка "В продаже" > Создается продажа > Проверется оказалась ли услуга через регистр Оказания услуг после продажи.
Устанавливаю настройку "В занятие" > Создается занятие с отметкой прибытия и статус Выполнен и затем сохраняется > Проверяется списание услуги также через регистр Оказания услуг.

4. **Сценарий: 04.** Проверка настройки персональной услуги "Не требуется привлечение тренера".
Включается настройка услуг > Создается занятие без указания тренера > Через регистр проверяется как списалось и указался ли тренер

5. **Сценарий: 05.** Проверка настройки персональной услуги "Требуется основание для записи".
Включается настройка в услуге > Создается занятие где ожидается вопроса с основание для записи.

6. **Сценарий: 06.** Проверка настройки персональной услуги "Использовать ассистента".
Создается второй тренер как ассистент и включается настройка ассистента в услуге > Создается занятие где поле ассистент заполняется если оно видно на форме и заполняет вторым тренером > Проверяется списание услуги и проверяется есть ли там ассистент.

7. **Сценарий: 07.** Проверка настройки персональной услуги "Отметка прибытия авто/ручная".
Отключение настройки ассистента > Создаем занятие с покупкой основания и сохраняем > Открывается рецепция и делается для клиента из занятия вход в клуб > Открывается документ Запись на занятие и в нем находится созданное нами занятие и проверяется проставилась ли отметка прибытия, если да то занятие выполняется и проверяется списание услуги.
Включается ручная отметка прибытия > Создается точно такое же занятие как и при автоматической отметки прибытия > С рецепции делается выход, а затем вход того же клиента что был при авто.отметке прибытия > Также проверяется на отметку прибытия.

8. **Сценарий: 08.** Проверка настройки персональной услуги "Вводная тренировка".
Устанавливается флаг вводной тренировки, создается занятие и проверяется списалась ли она.

9. **Сценарий: 09.** Проверка настройки персональной услуги "Вводная тренировка".
Создается второй клиент > Устснавливается настройка в услуге > Создается занятие для сплит тренировки и в нем указываются два клиента > В оказание услуг проверяется произошло ли списание.

10. **Сценарий: 10.** Проверка смены в персональном занятие тренера, услуги, переноса по времени.
Создается Помещение2, Услуга2 > Снимается в услуге1 флаг сплит тренировки > Создается занятие с самыми первыми данные > Открывается по навигационной ссылке созданное занятие и делается смена данных > Потом через регистр Оказания услуг проверяется все ли новые данные туда подтянулись.

11. **Сценарий: 11.** Проверка списания персональной услуги с настройками Если клиент:"Записан и не отменил" и "Записан, прибыл и подтвердил".
Устанавливается в услуге настройка "Записан и не отменил" > Создается экспортом занятие > Проверяется через документ Запись на занятие разрешено ли списание услуги после выполнения занятия.
Устанавливается в услуге настройка "Записан, прибыл и подтвердил" > Создание эскпортом занятие, где есть проверка на кнопки подтверждения, если она есть, то ее нажимаем и ставится отметка прибытия > Проверяем в документе Запись на занятие разрешено ли списание и подтверждено ли оно.

12. **Сценарий: 12.** Проверка отмены персонального занятия.
Создаются две причины отказа от Клиента и от Клуба > Создаются два занятия одно отменено по инициативе Клиента, второе по инициативе Клуба > Проверяется через документ Запись на занятие проставились корректные причины отказа и какой статус прибытия.

13. **Сценарий: 13.** Проверка списания персональной услуги с помощью отмены занятия со штрафом.
Создается причина отказа от Клиента со штрафом если клиент не пришел в течение часа > Создается занятие со временем начала на час назад от текущего времени и выставляется проводится > Проверяется через регистр Оказания услуг списалась ли услуга.

## Описание автотеста проверки занятий - Визит в салон красоты

1. **Сценарий: 01.** Я создаю данные для проверки занятий.
Создаются: Услуга визит в салон красоты 1 и 2, Помещение салона карсоты, Два мастера СК, Клиента.
Включается также константа "ИспользоватьНовуюФормуСалонаКрасоты".

2. **Сценарий: 02.** Проверка созданных данных.
Проверка прошлого сценария на ошибки, если они есть, останавливает фичу.

3. **Сценарий: 03.** Проверка настройки визита в салон красоты "Не требуется привлечение тренера".
В данной сценария проверяется просто смена данных и списание услуг.

## Описание автотеста проверки занятий - Вводный пакет услуг(Пробный)

От `22.01.2025` сценарий был переделан и были убраны ряд не нужных сценариев и был реализован под тикет `611118`.

1. **Сценарий: 01.** Я создаю данные для проверки вводного пакета услуг.
Создаются: Персональная, Групповая, Аренда зала - услуги, Помещение, Трене, Клиент и Пробныйпакет услуг(со всеми созданными услугами ранее).

2. **Сценарий: 02.** Проверка созданных данных.
Проверка прошлого сценария на ошибки, если они есть, останавливает фичу.

3. **Сценарий: 03.** Проверка автоматического заполнения основания в персональном занятии.
Создается занятие, указываются все данные и в случае, если в основание клиента появился созданный нами пробный пакет услуг, то в методе Попытка/Исключение мы это проверяем и выдаем исключение из-за которого сценарий останавливает и информирует об ошибке, в случае если основание пустое, то сценарий продолжает свое выполнение.

4. **Сценарий: 04.** Проверка списания персональной услуги.
Сначала проверяет корректно ли завершился сценарий 3, если нет, то завершает выполнеие фичи, а если всё корректно то проверяет списание услуги в членстве через регистр накопления.

5. **Сценарий: 05.** Проверка автоматического заполнения основания в групповом занятии.
Аналогично реализовано как в сценарии 3.

6. **Сценарий: 06.** Проверка списания групповой услуги.
Реализовано аналогично сценарию 4.

## Описание автотеста проверки занятий - Вводное членство(Пробный)

От `22.01.2025` сценарий был переделан и были убраны ряд не нужных сценариев и был реализован под тикет `611118`.

1. **Сценарий: 01.** Я создаю данные для проверки вводного членства.
Создаются услуги: Персональная, Групповая, Аренда зала. Помещение, Тренер, Клиент, Пробное членство.

2. **Сценарий: 02.** Проверка созданных данных.
Проверка прошлого сценария на ошибки, если они есть, останавливает фичу.

3. **Сценарий: 03.** Проверка автоматического заполнения основания в персональном занятии.
Создается занятие, указываются все данные и в случае, если в основание клиента появился созданный нами пробное членство, то в методе Попытка/Исключение мы это проверяем и выдаем исключение из-за которого сценарий останавливает и информирует об ошибке, в случае если основание пустое, то сценарий продолжает свое выполнение.

4. **Сценарий: 04.** Проверка списания персональной услуги.
Сначала проверяет корректно ли завершился сценарий 3, если нет, то завершает выполнеие фичи, а если всё корректно то проверяет списание услуги в членстве через регистр накопления.

5. **Сценарий: 05.** Проверка автоматического заполнения основания в групповом занятии.
Аналогично реализовано как в сценарии 3.

6. **Сценарий: 06.** Проверка списания групповой услуги.
Реализовано аналогично сценарию 4.
