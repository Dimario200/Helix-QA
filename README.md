# ГРМ

**ГРМ** — сервис 1С, в который необходимо отправить файл `.dt`, полученный из пустой базы актуальной версии релиза.

- Отправка происходит после того, как 1С опубликовали релиз на портале.

## Файлы

Все файлы хранятся в папке `GRM`:

- **`Jenkinsfile`** — основной файл запуска всего процесса отправки в Jenkins.
- **`cleaning.py`** — удаляет содержимое папок `D:\dt` и `D:\cf`.
- **`transfer.py`** — копирует файл `.cf` из папки сборки релизов (`Old_versions_cf`).
- **`upload_file.py`** — выполняет PUT-запрос для отправки файла в ГРМ.

## Принцип работы

1. Удаляется содержимое папок `D:\dt` и `D:\cf`.
2. Получение ссылки предписания.
3. Файл `.cf` переносится из `Old_versions_cf` в `D:\cf`, загружается в пустую базу, обновляется конфигурация, затем выгружается `.dt` в папку `D:\dt`.
4. Файл `.dt` загружается в объектное хранилище.
5. Устанавливается версия по умолчанию.

## Запуск

**Процесс полностью автоматизирован**.

Запуск производится через **Jenkins**:  
**Сборки релизов → GRM → Собрать с параметрами**.
Агент выполнения (`OneS`) находится на 71 сервере.  

### Параметры запуска

- **`nameProduct`** — указывается в зависимости от продукта, который отправляем (`finessCorp`, `SpaSalon3`, `salon30`).
- **`version`** — устанавливаем версию в формате `x.x.xx.x`.
- **`jenkinsAgent`** — имя агента устанавливается по умолчанию (изменять не нужно).

# Сверка идентификаторов

**Сверка идентификаторов** — процесс выгрузки конфигурации в xml файлы, из рабочего и релизного хранилища.
После чего код проверяется на различие идентификаторов.

## Файлы

Все файлы хранятся в папке `IDENTIFICATOR`:

- **`c_jenkins`** — основной файл запуска Jenkins - **Стоматология**.
- **`f_jenkins`** — основной файл запуска Jenkins - **Фитнес**.
- **`s_jenkins`** — основной файл запуска Jenkins - **Салон**.
- **`telegram_file_sender.py`** — файл отправки сообщения с результами в виде картинки с результатми в **telegram**.
- **`configuration_comparison_manager.py`** — файл формирующий каритнку в формате excel с результатом сверки.

## Запуск

**Процесс полностью автоматизирован**.

Запуск производится через **Jenkins**:  
**Сверка идентификаторов** → FITNESS
						   → SALON
						   → STOMA
Агент выполнения (`master`) находится на 71 сервере.  

### Параметры запуска

- **`nameProduct`** — указывается в зависимости от продукта, который отправляем (`finessCorp`, `SpaSalon3`, `salon30`).
- **`version`** — устанавливаем версию в формате `x.x.xx.x`.
- **`jenkinsAgent`** — имя агента устанавливается по умолчанию (изменять не нужно).